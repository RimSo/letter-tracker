{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">

    <div class="d-flex align-items-center gap-2">
        <!-- Back Button -->
        <a href="{{ url_for('admin_dashboard') }}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Back
        </a>

        <h3 class="ms-2">üì¨ All Letters</h3>
    </div>

</div>

<div class="card shadow-sm">
  <div class="card-header"><strong>All Letters</strong></div>

  <div class="table-responsive">
    <table class="table table-striped">
      <thead class="table-light">
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Name</th>
          <th>Type</th>
          <th>To</th>
          <th>From</th>
          <th>Sent</th>
          <th>Received</th>
          <th>Tracking</th>
        </tr>
      </thead>
      <tbody>
  {% for l in letters %}
  <tr>
    <td>{{ l.id }}</td>

    <td>

  {% set u = users_map.get(l.user_id) %}
  {% if u %}

  <a href="{{ url_for('admin_users') }}#user-{{ l.user_id }}"
     class="d-inline-flex align-items-center text-decoration-none"
     data-bs-toggle="tooltip"
     title="{{ u.email }}">

      <!-- Avatar -->
      <img src="{{ url_for('static', filename='avatars/' ~ u.avatar) }}"
           class="rounded-circle me-2"
           style="width:28px; height:28px; object-fit:cover;">

      <!-- Name badge -->
      <span class="badge text-bg-primary">
          {{ u.name }}
      </span>

      <!-- Admin badge -->
      {% if u.is_admin %}
      <span class="badge text-bg-warning ms-1">
          ‚≠ê Admin
      </span>
      {% endif %}
  </a>

  {% else %}
      <span class="badge text-bg-secondary">Unknown User</span>
  {% endif %}

</td>

    <td>{{ l.name }}</td>
    <td>{{ l.letter_type }}</td>
    <td>{{ l.to_country }}</td>
    <td>{{ l.from_country }}</td>
    <td>{{ l.sent_date }}</td>
    <td>{{ l.received_date }}</td>
    <td>{{ l.tracking }}</td>
  </tr>
  {% endfor %}
</tbody>
    </table>
  </div>
</div>
{% endblock %}